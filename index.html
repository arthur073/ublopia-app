<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="css/style.css" rel="stylesheet" media="screen">
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">

    <script type="text/javascript" src="phonegap.js"></script>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/app.js"></script>

    <title>Ublopia</title>
</head>
<body>



<div class="navbar navbar-inverse">
    <div class="navbar-inner">
        <a class="brand" href="#">Ublopia</a>
        <a id="btnRefresh" href="#" class="btn btn-danger pull-right" onclick="refresh();">Refresh</a>
    </div>
</div>


<div id="container" class="container-fluid">


    <div class="row-fluid">


        <div class="span10">
            <div id="listNotif" class="row-fluid">

                <ul class="thumbnails">
                    <li class="span4">
                        <div class="thumbnail">
                            <img data-src="holder.js/300x200" style="width: 300px; height: 150px;" src="img/shop.jpg">
                            <div class="caption">
                                <h3>Wanna go shopping ?</h3>
                                <p>I have found your shopping list and you still have items to buy. Here is a shop where you can go !</p>
                                <p><a href="#" class="btn btn-danger">Take me there !</a></p>
                            </div>
                        </div>
                    </li>
                </ul>

                <ul class="thumbnails">
                    <li class="span4">
                        <div class="thumbnail">
                            <img data-src="holder.js/300x200" style="width: 300px; height: 150px;" src="img/movie.jpg">
                            <div class="caption">
                                <h3>Want to see a movie ?</h3>
                                <p>I know that you are interested in Sci-Fi movies, why don't you check this one out ?</p>
                                <p><a href="#" class="btn btn-danger">Take me there !</a></p>
                            </div>
                        </div>
                    </li>
                </ul>


            </div>
        </div>
    </div>
</div>




<script>

    function refresh() {

        function httpGet(theUrl)
        {
            var xmlHttp = null;

            xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", theUrl, false );
            xmlHttp.send( null );
            var jsonArray = JSON.parse(xmlHttp.responseText);

            for (var i=1; i < jsonArray.length; i++){
                var values = jsonArray[i].value.split('##');
                insertElem(values[0],values[2],'eat.jpg');
            }
        }

        httpGet("http://tuple-center.herokuapp.com/take/user1/notifications.json?passwd=356a192b7913b04c54574d18c28d46e6395428ab");
    }

    function insertElem(title, content, imglink) {
        var listToInsert = document.getElementById("listNotif");
        var insertBefore = listToInsert.childNodes[1];

        var ulToInsert = document.createElement("ul");
        ulToInsert.className = "thumbnails blink";

        var liToInsert = document.createElement("li");
        liToInsert.className = "span4";
        var divToInsert = document.createElement("div");
        divToInsert.className = "thumbnail";


        var img = document.createElement("img");
        img.src = "img/" + imglink;
        img.style.height = '150px';
        img.style.width = '300px';

        var titlecaption = document.createElement("h3");
        titlecaption.innerHTML = title;

        var contentcaption = document.createElement("p");
        contentcaption.innerHTML = content;

        var buttoncaption = document.createElement("p");
        buttoncaption.innerHTML = '<a href="#" class="btn btn-danger">Take me there !</a>';

        var caption = document.createElement("div");
        caption.className = "caption"
        caption.appendChild(titlecaption);
        caption.appendChild(contentcaption);
        caption.appendChild(buttoncaption);

        divToInsert.appendChild(img);
        divToInsert.appendChild(caption);
        liToInsert.appendChild(divToInsert);
        ulToInsert.appendChild(liToInsert);

        listToInsert.insertBefore(ulToInsert, insertBefore);
    }
</script>

</body>
</html>
